
################# D. Lomidze & A. Cimmino INFN NAPOLI ############$

process TEST = {

include "EventFilter/RPCRawToDigi/data/RPCFrontierCabling.cfi"

source = PoolSource {
	untracked vstring fileNames =   
	 {
'/store/data/GlobalCruzet1/A/000/000/000/RAW/0009/0257C781-FC1D-DD11-AB54-000423D6B5C4.root'

#'/store/data/2008/5/20/T0ReReco-GlobalCruzet1-A-v1/0004/1ABA1731-C426-DD11-BD6F-0030487A18F2.root'
#   'rfio:/castor/cern.ch/cms/T0/RepackerTest/store/data/CRUZET1/Cosmics/RAW/v1/000/043/434'

#'/store/data/GlobalMar08/A/000/037/893/GlobalMar08.00037893.0001.A.storageManager.0.0000.dat'

       #    'file:/afs/cern.ch/user/c/cimmino/scratch0/gren30126_1_digi.root'	

     		# 	 'file:/afs/cern.ch/user/d/dlomidze/scratch0/digi/gren30126_1_digi_new.root'
		# 'file:/afs/cern.ch/user/d/dlomidze/scratch0/digi/gren30126_2_digi.root',	
 		# 'file:/afs/cern.ch/user/d/dlomidze/scratch0/digi/gren30126_3_digi.root'
		#'file:/tmp/dlomidze/gren30129_3_digi.root'
		}
        # untracked string moduleLogName= "RPCDigiDQM"
	untracked string moduleLogName= "source"
	}


untracked PSet maxEvents = {untracked int32 input = 5}

service = MessageLogger {
	untracked vstring destinations = {"RpcMonitoring.log"}
       	PSet RpcUnpacker.log     = {untracked bool noLineBreaks = true   }
        PSet detailedInfo.txt = {untracked int32  lineLength = 132    }        
	}

 #################    Raw To Digi:   #########################

 include "EventFilter/RPCRawToDigi/data/RPCUnpacking.cfi"

 #################    Data Quality Monitoring:   #########################
 include "DQM/RPCMonitorDigi/data/RPCDigiMonitoring.cfi"
	replace rpcdigidqm.DigiEventsInterval = 100

	# File will be saved by the DQMFileSaver---> leave this to false
	replace rpcdigidqm.DigiDQMSaveRootFile =false
	replace rpcdigidqm.RootFileNameDigi="/tmp/cimmino/gren129_3_out.root"

	replace rpcdigidqm.dqmshifter =true   	    	
	replace rpcdigidqm.dqmexpert =true		
	replace rpcdigidqm.dqmsuperexpert =true    	


include "DQMServices/Core/data/DQM.cfg"
	replace DQM.collectorHost = "myhost"
	replace DQM.collectorPort = 9090
	replace DQM.debug = false

service = ModuleWebRegistry {}
service = LockService {untracked vstring labels = {"source"} }	

 #################   For RPCRecHits   #########################
include "Geometry/MuonNumbering/data/muonNumberingInitialization.cfi"
include "MagneticField/Engine/data/volumeBasedMagneticField.cfi"
include "Geometry/MuonCommonData/data/muonIdealGeometryXML.cfi"
include "Geometry/RPCGeometry/data/rpcGeometry.cfi" 

#The module for 1D RPC RecHit building
include "RecoLocalMuon/RPCRecHit/data/rpcRecHits.cfi"
     replace rpcRecHits.rpcDigiLabel = "rpcunpacker"

 #################   Output module  #########################
module out = PoolOutputModule {
       untracked string fileName ="RPCDQM.root"
}

#################   QTest module  #########################
# run the quality tests as defined in QualityTests.xml    
module qTesterRPC = QualityTester {
	untracked int32 QualityTestPrescaler = 1
	untracked FileInPath qtList = "DQM/RPCMonitorClient/test/RPCQualityTests.xml"
}

include "DQM/RPCMonitorClient/data/RPCQualityTests.cfi" 


#################   DQMFileSaver module  #########################
module dqmSaverRPC = DQMFileSaver{
#if you do not want to save the file, put this to false
untracked bool saveAtRunEnd = true

# if ==Offline workflow may not be ="" 

untracked string convention = "Online"
untracked string dirName = "."

#the fileName MUST be the subsystem name
untracked string fileName = "RPC"
}

########## DQMEventInfo module  #########################
module dqmEventInfoRPC = DQMEventInfo{

untracked string eventInfoFolder = "EventInfo"
untracked  string subSystemFolder ="RPC"

#given in minutes ---0.5 default ---0.15 minimum
untracked double eventRateWindow = 0.5
}

include "DQM/RPCMonitorClient/data/RPCEventSummary.cfi"
replace rpcEventSummary.EventInfoPath = "RPC/EventInfo"
replace rpcEventSummary.RPCPrefixDir = "RPC/RecHits"


############### RPC Trigger Filter ################
include "DQM/RPCMonitorClient/data/RPCTriggerFilter.cfi"
replace rpcTriggerFilter.RPCTrigger = false 
 replace rpcTriggerFilter.DTTrigger = true


#################   Path   #########################

sequence rpcDigi = {rpcunpacker,rpcRecHits,rpcdigidqm}
#sequence rpcClient ={qTesterRPC, rpcqualitytests,dqmEventInfoRPC,rpcEventSummary,dqmSaverRPC}
sequence rpcClient ={dqmEventInfoRPC,rpcEventSummary,dqmSaverRPC}
path p = {rpcDigi ,rpcClient}
#path p = {rpcunpacker}
}
